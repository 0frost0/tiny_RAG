检索增强生成（RAG, Retrieval-Augmented Generation）是一种结合了检索系统和大型语言模型（LLM）的技术架构。它的主要目的是解决大模型存在的“幻觉”问题以及知识库过时的问题。

RAG 的核心原理可以分为三个主要阶段：索引（Indexing）、检索（Retrieval）和生成（Generation）。

1. 索引阶段：
这是预处理阶段。首先将原始文档（如PDF、Word或Markdown）进行清洗，然后使用切片算法（Chunking）将其分割成较短的文本块。接着，利用 Embedding 模型将这些文本块转化为高维向量（Vector），并存储在向量数据库（Vector Database）中。

2. 检索阶段：
当用户提出问题时，系统会使用同样的 Embedding 模型将用户的问题也转化为向量。然后，系统会在向量数据库中计算用户问题向量与存储的文档向量之间的余弦相似度（Cosine Similarity），从而找出与问题最相关的 Top-K 个文本片段。

3. 生成阶段：
系统将检索到的相关文本片段作为“背景知识（Context）”，与用户的问题一起组装成一个完整的 Prompt。最后，将这个 Prompt 发送给大语言模型（如 GPT-4 或 Qwen）。大模型会基于提供的背景知识，生成准确且基于事实的回答。

相比于传统的 Fine-tuning（微调），RAG 的优势在于成本低、更新数据快，且能提供可解释的引用来源。